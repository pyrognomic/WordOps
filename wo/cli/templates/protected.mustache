{{#wp}}
# Limit access to avoid brute force attack
location = /wp-login.php {
  {{#secure}}
  satisfy any;
  # Allowed IP Address List
  allow 127.0.0.1;
  allow ::1;
  deny all;
  auth_basic "Restricted Area";
  auth_basic_user_file /etc/nginx/acl/{{slug}}/credentials;
  {{/secure}}
  limit_req zone=one burst=1 nodelay;
  include fastcgi_params;
  fastcgi_pass unix:/run/php/php{{php_ver}}-fpm-{{pool_name}}.sock;
}
{{/wp}}
{{^wp}}
{{#secure}}
satisfy any;
# Allowed IP Address List
allow 127.0.0.1;
allow ::1;
deny all;
auth_basic "Restricted Area";
auth_basic_user_file /etc/nginx/acl/{{slug}}/credentials;
{{/secure}}
{{/wp}}
